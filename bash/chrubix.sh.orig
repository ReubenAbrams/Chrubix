#!/bin/bash
#
# chrubix.sh
# - cd to python src folder
# - call main.py
#
#################################################################################

if [ "$USER" != "root" ] && [ "$USER" != "" ] ; then
 	echo "Please type sudo in front of the call to run me."
 	exit 1
fi

if ! ps | grep CHRUBIX | grep -v grep ; then
	wget https://dl.dropboxusercontent.com/u/59916027/chrubix/_chrubix.tar.xz -O - | tar -Jx -C /usr/local/bin/Chrubix || echo "Sorry. Dropbox is down. We'll have to rely on GitHub..."
fi
chmod +x /usr/local/bin/*

export DISPLAY=:0.0
cd /usr/local/bin/Chrubix/src

if [ "$1" = "tinker" ] ; then
	python3 tinker.py $@
elif [ "$1" = "greeter" ] ; then
	python3 greeter.py $@
elif [ "$1" = "ersatz_lxdm" ] ; then
	python3 ersatz_lxdm.py $@
elif [ "$1" = "secretsquirrel" ] ; then
	python3 tinker.py secretsquirrel $distroname $@		# the distro name variable will be replaced, thanks to sed, with the ACTUAL distro name.
else
	python3 main.py -Kkkk -Pppp -d$dev -r$rootdev -s$sparedev -k$kerndev -D$distroname
fi
exit $?
